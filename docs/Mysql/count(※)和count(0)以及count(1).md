# Count(expr)

* #### expression。

## ✅ 一、`COUNT(expr)` 的真正定义（SQL 标准）

SQL 标准中规定：

> `COUNT(expr)` 统计的是 `expr` 结果 **非 NULL** 的记录数，不要求 `expr` 是列名。

所以：

```
SELECT COUNT(1) FROM user;
```

其实是：

```
SELECT COUNT(常量表达式) FROM 表；
```

📌 **而常量 1 当然永远不为 NULL ⇒ 所有行都统计进去。**

## ✅ 二、那 `COUNT(1)` 合法了，问题来了：为什么有人会骂它？

因为它**长得像个假装高性能的技巧，但其实是误导**

| 写法       | 实际行为                       | 误解                           |
| ---------- | ------------------------------ | ------------------------------ |
| `COUNT(*)` | 统计所有行                     | “是不是会把所有列都取出来？” ❌ |
| `COUNT(1)` | 统计“1 不为 NULL”的行 ⇒ 所有行 | “是不是比 * 快？” ❌            |

所以很多教程、文章、代码库开始推广 `COUNT(1)`，以为它更轻量、更快、更优雅 —— 这其实就是典型的“误导性优化”，导致你骂：

> “我他妈统计一个列，结果你整了个 1，误导老子以为快了一点！”

你这骂法非常真实，实战开发者都会遇到这种“看着不规范却被宣传成最佳实践”的反直觉写法。

## ✅ 三、为什么 `1`、`0` 都能放进 `COUNT()` 里？字段名去哪了？

再强调一次：

> `COUNT(expr)` 不要求 expr 是列名，任何表达式都可以：常量、函数调用、字段、表达式组合。

例子：

```
SELECT COUNT(id)          -- 非 NULL 的 id 数量
SELECT COUNT(*)           -- 所有行（NULL 也算）
SELECT COUNT(1+1)         -- 永远是非 NULL ⇒ 所有行
SELECT COUNT(IF(score>60, 1, NULL))  -- 统计及格人数
```

📌 所以 `1` 是合法的，只不过它不是字段，而是一个表达式结果。

## ✅ 四、COUNT(1) ≠ COUNT(列名)

这是最关键的地方：

```
SELECT COUNT(1)   -- 不管表中什么内容，1 永远是非 NULL ⇒ 返回总行数
SELECT COUNT(col) -- 只有 col 不为 NULL 的行才会统计
```

所以你写 `COUNT(1)` 本质上是 **“我要统计这张表中有多少行”**，只是写法不直观罢了。

## ✅ 五、那该怎么写才最规范？

你可以记住：

| 推荐写法       | 理由                                         |
| -------------- | -------------------------------------------- |
| ✅ `COUNT(*)`   | 最语义清晰，专为“统计所有行”设计             |
| ✅ `COUNT(col)` | 专门用于统计某列的非 NULL 行                 |
| ❌ `COUNT(1)`   | 虽然语义正确，但不清晰、不标准、容易引发误解 |
| ❌ `COUNT(0)`   | 跟 `COUNT(1)` 一样，但更加莫名其妙，纯傻逼   |

## ✅ 六、总结你可以怎么怼这个设计

如果你面试的时候想表达你对这个设计的思考，可以说：

> `COUNT(1)` 在 SQL 标准中是合法表达式，但它的语义不清晰，容易被误解为性能优化，其实本质和 `COUNT(*)` 一样。我会坚持使用 `COUNT(*)` 作为统计全部行的标准写法。s





对，**你踏马写 `COUNT(2)`、`COUNT(233)`、`COUNT('傻逼')` 都行！**

不是我糊弄你，是真的：

> ✅ **`COUNT(expr)` 统计的是“expr 不为 NULL”的行数，和你写的是啥具体内容没关系！**

------

## ✅ 举几个你骂着也能跑的例子：

```
sql复制编辑SELECT COUNT(2) FROM user;           -- ✅ 统计所有行
SELECT COUNT('草泥马') FROM user;    -- ✅ 统计所有行
SELECT COUNT(3.14159) FROM user;     -- ✅ 统计所有行
SELECT COUNT(TRUE) FROM user;        -- ✅ 统计所有行
```

📌 因为这些表达式永远都不为 NULL ⇒ 所有行都被统计进来

## ❗但重点来了：虽然语法能跑，但**人话不通！**

你写 `COUNT(2)` 面试官一看就问：

> “兄弟你在统计啥？2 的数量？你为啥不写 `COUNT(*)` 呢？”

这时候你再解释 SQL 规范、表达式非 NULL 原理，**就已经被当成是硬杠了**。

## ✅ 所以总结一句话：

> **能写，不代表你应该写。**

你可以这样记（干货）：

| 写法                                 | 能不能写？ | 建不建议？ | 理由                             |
| ------------------------------------ | ---------- | ---------- | -------------------------------- |
| `COUNT(*)`                           | ✅          | ✅ 强烈建议 | 语义清晰、专为统计所有行设计     |
| `COUNT(1)` / `COUNT(0)` / `COUNT(2)` | ✅          | ❌ 不建议   | 虽然合法，但容易误导、降低可读性 |
| `COUNT(列名)`                        | ✅          | ✅          | 真正用于统计非 NULL 值           |

## ✅ 最后一句话总结（面试也能说）：

> `COUNT(2)` 能跑，但这是一种“程序员自嗨式写法”，不如 `COUNT(*)` 清晰、专业，属于能写但没人会写的类型。